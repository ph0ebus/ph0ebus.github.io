<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>ph0ebus&#39;s Blog</title>
  <meta name="author" content="ph0ebus">
  
  <meta name="description" content="ph0ebus&#39;s Blog">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="ph0ebus&#39;s Blog"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/search.xml" title="ph0ebus&#39;s Blog" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>






<meta name="generator" content="Hexo 7.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">ph0ebus&#39;s Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/search.xml" title="Subscribe me.">
			  <i class="fa fa-user"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header logo">
  <h1>ph0ebus&#39;s Blog<span class="blink-fast">|</span></h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">


		<i class="fa fa-heart blink-slow"></i>

		no hack no fun...

</div>    

		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/04/09/CVE-2024-36465 Zabbix SQL注入漏洞分析/" title="首发于奇安信攻防社区 https://forum.butian.net/article/690">CVE-2024-42327 Zabbix SQL注入漏洞分析</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-04-09  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><blockquote>
<p>仅供学习交流，请勿用于非法行为</p>
</blockquote>
<p>看到有公众号发了漏洞描述，但没有详情，直接分析一手</p>
<h1 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h1><p>Zabbix 是一款开源的网络监控和报警系统，用于监视网络设备、服务器和应用程序的性能和可用性。</p>
<p>一个具有 API 访问权限的低权限（常规）Zabbix 用户可以利用 include&#x2F;classes&#x2F;api&#x2F;CApiService.php 中的 SQL 注入漏洞，通过 groupBy 参数执行任意 SQL 命令。</p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><p><img src="https://shs3.b.qianxin.com/attack_forum/2025/04/attach-d8f6844232d4ed3afd1d81118b86e06bcf536bf9.png" alt="image.png"></p>
<p>7.0.0 &lt;&#x3D; zabbix &lt;&#x3D; 7.0.7</p>
<p>7.2.0 &lt;&#x3D; zabbix &lt;&#x3D; 7.2.1</p>
	
	</div>
  <a type="button" href="/2025/04/09/CVE-2024-36465 Zabbix SQL注入漏洞分析/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/04/03/Apache Pinot CVE-2024-56325 Authentication Bypass 漏洞分析/" title="首发于奇安信攻防社区 https://forum.butian.net/article/685">Apache Pinot CVE-2024-56325 Authentication Bypass 漏洞分析</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-04-03  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>前两天看到这条通告，一搜发现评分 9.8，于是分析一下具体怎么个事</p>
<p><a target="_blank" rel="noopener" href="https://www.openwall.com/lists/oss-security/2025/03/27/8">https://www.openwall.com/lists/oss-security/2025/03/27/8</a></p>
<h1 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h1><p>Apache Pinot 是一个实时分布式的 OLAP 数据存储和分析系统。使用它实现低延迟可伸缩的实时分析。Pinot 从离线数据源（包括 Hadoop 和各类文件）和在线数据源（如 Kafka）中攫取数据进行分析。</p>
<p>Apache Pinot 存在身份认证绕过漏洞。如果路径不包含 <code>/</code> 且包含 <code>.</code>则不需要身份验证。</p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><p>Apache Pinot &lt; 1.3</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>参考官方文档</p>
	
	</div>
  <a type="button" href="/2025/04/03/Apache Pinot CVE-2024-56325 Authentication Bypass 漏洞分析/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/03/25/CISCN-长城杯半决赛ISW部分Writeup/" title="AWDP坐大牢，靠ISW拯救一下">CISCN-长城杯半决赛ISW部分Writeup</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-03-25  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="数据管理"><a href="#数据管理" class="headerlink" title="数据管理"></a>数据管理</h1><p>猜测是任意文件读取</p>
<p><img src="https://s2.loli.net/2025/03/25/YnFzZyGiAh9O5RE.png" alt="image-20250316141246133"></p>
<p>通过读取&#x2F;proc&#x2F;self&#x2F;cmdline可以定位到jar包，下载后找到shirokey</p>
<p><img src="https://s2.loli.net/2025/03/25/iKuweLVAsndJhQo.png" alt="image-20250316141311170"></p>
<p>直接打shiro反序列化</p>
<p><img src="https://s2.loli.net/2025/03/25/aQGbYqoMBLTArKs.png" alt="image-20250316141329853"></p>
<p>注入内存马</p>
<p><img src="https://s2.loli.net/2025/03/25/F5PlT2LKGbtCfd4.png" alt="image-20250316141345139"></p>
<p>写入.ssh公钥</p>
	
	</div>
  <a type="button" href="/2025/03/25/CISCN-长城杯半决赛ISW部分Writeup/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/03/11/Apache Tomcat CVE-2025-24813 漏洞分析复现/" >Apache Tomcat CVE-2025-24813 漏洞分析复现</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-03-11  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h1><p>Apache Tomcat是一个流行的开源 Web 服务器和 Java Servlet 容器。</p>
<p>Apache Tomcat 应用程序在启用了servlet的写入功能（默认禁用）、使用Tomcat文件会话持久化、存储机制默认位置且包含可反序列化利用的依赖库时可以上传恶意序列化流，并触发反序列化进行进一步利用，可造成远程命令执行等危害。</p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><p>11.0.0-M1 &lt;&#x3D; Apache Tomcat &lt;&#x3D; 11.0.2</p>
<p>10.1.0-M1 &lt;&#x3D; Apache Tomcat &lt;&#x3D; 10.1.34</p>
<p>9.0.0.M1 &lt;&#x3D; Apache Tomcat &lt;&#x3D; 9.0.98</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>修改 tomcat 安装目录中 conf&#x2F;web.xml 文件，设置 readonly 为 false</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 启用写入 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>readonly<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>
	
	</div>
  <a type="button" href="/2025/03/11/Apache Tomcat CVE-2025-24813 漏洞分析复现/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2024/12/20/Apache Struts S2-067 漏洞分析/" title="CVE-2024-53677">Apache Struts S2-067 漏洞分析</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2024-12-20  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p><a target="_blank" rel="noopener" href="https://y4tacker.github.io/2024/12/16/year/2024/12/Apache-Struts2-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%80%BB%E8%BE%91%E7%BB%95%E8%BF%87-CVE-2024-53677-S2-067/">Apache-Struts2-文件上传逻辑绕过-CVE-2024-53677-S2-067 - y4tacker</a></p>
<h1 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h1><p>Apache Struts 是一个开源的、用于构建企业级Java Web应用的MVC框架。2024年12月，Apache 官方披露 CVE-2024-53677 Apache Struts FileUploadInterceptor 文件上传漏洞。在受影响版本中，若代码中使用了FileUploadInterceptor，当进行文件上传时，攻击者可能构造恶意请求利用目录遍历等上传文件至其他目录，在特定场景下可能造成代码执行。</p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><p>Struts 2.0.0 - Struts 2.3.37</p>
<p>Struts 2.5.0 - Struts 2.5.33</p>
<p>Struts 6.0.0 - Struts 6.3.0.2</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p><a target="_blank" rel="noopener" href="https://github.com/proudwind/struts2_vulns/tree/master/s2vuls">https://github.com/proudwind/struts2_vulns/tree/master/s2vuls</a></p>
<p>第一次复现struts的漏洞，借助了这个项目搭建环境（自己尝试从零搭环境发现达不到预期效果，访问<code>upload.action</code>返回404，怪）</p>
	
	</div>
  <a type="button" href="/2024/12/20/Apache Struts S2-067 漏洞分析/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2024/12/20/CVE-2024-42327 Zabbix SQL注入漏洞分析/" title="首发于奇安信攻防社区 https://forum.butian.net/article/639">CVE-2024-42327 Zabbix SQL注入漏洞分析</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2024-12-20  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h1><p>Zabbix 是一款开源的网络监控和报警系统，用于监视网络设备、服务器和应用程序的性能和可用性。</p>
<p>攻击者可以通过API接口，向 user.get API端点发送恶意构造的请求，注入SQL代码，以实现权限提升、数据泄露或系统入侵。</p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><p><img src="https://s2.loli.net/2024/12/20/26EGzIoJ9CemNAZ.png" alt="img"></p>
<p>6.0.0 &lt;&#x3D; Zabbix &lt;&#x3D; 6.0.31</p>
<p>6.4.0 &lt;&#x3D; Zabbix &lt;&#x3D; 6.4.16</p>
<p>Zabbix 7.0.0</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>参考<a target="_blank" rel="noopener" href="https://forum.butian.net/share/3056">https://forum.butian.net/share/3056</a></p>
	
	</div>
  <a type="button" href="/2024/12/20/CVE-2024-42327 Zabbix SQL注入漏洞分析/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2024/12/20/kkFileView历史漏洞总结/" title="kkFileView历史漏洞总结">kkFileView历史漏洞总结</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2024-12-20  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<blockquote>
<p>首发于奇安信攻防社区 <a target="_blank" rel="noopener" href="https://forum.butian.net/article/631">https://forum.butian.net/article/631</a></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/kekingcn/kkFileView">https://github.com/kekingcn/kkFileView</a></p>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>kkFileView为文件文档在线预览解决方案，该项目使用流行的spring boot搭建，易上手和部署，基本支持主流办公文档的在线预览，如doc,docx,xls,xlsx,ppt,pptx,pdf,txt,zip,rar,图片,视频,音频等等</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>以v3.6.0环境搭建为例</p>
<p>首先从dockerhub下载官方docker镜像</p>
<p><img src="https://s2.loli.net/2024/12/20/jZiELl9JxN3g7bk.png" alt="img"></p>
<p>pull下来后执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 8012:8012 -p 5005:5005 -it --entrypoint /bin/bash  keking/kkfileview:v3.6.0</span><br></pre></td></tr></table></figure>
	
	</div>
  <a type="button" href="/2024/12/20/kkFileView历史漏洞总结/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2024/12/15/Apache Struts S2-066 漏洞分析/" title="CVE-2023-50164">Apache Struts S2-066 漏洞分析</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2024-12-15  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p><a target="_blank" rel="noopener" href="https://y4tacker.github.io/2023/12/09/year/2023/12/Apache-Struts2-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%86%E6%9E%90-S2-066/">Apache Struts2 文件上传分析(S2-066) - y4tacker</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/13834">Struts2 S2-066漏洞浅析 - zh1z****</a></p>
<h1 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h1><p>Apache Struts 2是一个基于MVC设计模式的Web应用框架，可用于创建企业级Java web应用程序。</p>
<p>由于文件上传逻辑存在缺陷，威胁者可操纵文件上传参数导致路径遍历，某些情况下可能上传恶意文件，造成远程代码执行。</p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><p>Struts 2.0.0 - Struts 2.3.37 (EOL)</p>
<p>Struts 2.5.0 - Struts 2.5.32</p>
<p>Struts 6.0.0 - Struts 6.3.0</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1>
	
	</div>
  <a type="button" href="/2024/12/15/Apache Struts S2-066 漏洞分析/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2024/12/12/fastjson1.2.80 in Springtboot新链学习/" title="fastjson1.2.80 in Springtboot">fastjson1.2.80 in Springtboot新链学习</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2024-12-12  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<blockquote>
<p>首发于先知社区：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/16708">https://xz.aliyun.com/t/16708</a></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.geekcon.top/doc/ppt/GC24_SpringBoot%E4%B9%8B%E6%AE%87.pdf">https://www.geekcon.top/doc/ppt/GC24_SpringBoot%E4%B9%8B%E6%AE%87.pdf</a></p>
<p><a target="_blank" rel="noopener" href="http://squirt1e.top/2024/11/08/fastjson-1.2.80-springboot-xin-lian/">http://squirt1e.top/2024/11/08/fastjson-1.2.80-springboot-xin-lian/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/luelueking/CVE-2022-25845-In-Spring">GitHub - luelueking&#x2F;CVE-2022-25845-In-Spring: CVE-2022-25845(fastjson1.2.80) exploit in Spring Env!</a></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>所有依赖 Fastjson 版本 1.2.80 或更早版本的程序，在应用程序中如果包含使用用户数据调用 <code>JSON.parse</code> 或 <code>JSON.parseObject</code> 方法，但不指定要反序列化的特定类，都会受此漏洞的影响。</p>
<p><img src="https://s2.loli.net/2024/12/06/XhsNtREHD1KzVrp.webp"></p>
<p>在之前的研究中针对fj1.2.80已经有了三种常见的利用场景</p>
<p><a target="_blank" rel="noopener" href="https://github.com/su18/hack-fastjson-1.2.80">GitHub - su18&#x2F;hack-fastjson-1.2.80</a></p>
<p><img src="https://s2.loli.net/2024/12/06/9lZtiaXscv7uyNq.png"></p>
	
	</div>
  <a type="button" href="/2024/12/12/fastjson1.2.80 in Springtboot新链学习/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2024/12/08/Apache Kafka CVE-2024-31141学习/" title="CVE-2024-31141 Apache Kafka Clients：Privilege escalation to filesystem read-access via automatic ConfigProvider">Apache Kafka CVE-2024-31141学习</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2024-12-08  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p><a target="_blank" rel="noopener" href="https://advisories.gitlab.com/pkg/maven/org.apache.kafka/kafka-clients/CVE-2024-31141/">CVE-2024-31141: Apache Kafka Clients: Privilege escalation to filesystem read-access via automatic ConfigProvider</a></p>
<h1 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h1><p><font style="color:rgb(55, 65, 81);">Apache Kafka 客户端接受配置数据以自定义行为，并包含 ConfigProvider 插件以操作这些配置。 Apache Kafka 还提供 FileConfigProvider、DirectoryConfigProvider 和 EnvVarConfigProvider 实现，其中包括从磁盘或环境变量读取的功能。在 Apache Kafka 客户端配置可以由不受信任方指定的应用程序中，攻击者可以使用这些 ConfigProvider 读取磁盘和环境变量的任意内容。</font></p>
<p><font style="color:rgb(55, 65, 81);">此问题影响 Apache Kafka 客户端：从 2.3.0 到 3.5.2、3.6.2、3.7.0。</font></p>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>根目录下创建1.properties文件</p>
<p><img src="https://s2.loli.net/2024/12/08/5kJXZ3oTtfNCcE2.png"></p>
<p>然后配置客户端连接的配置项，在真实场景下存在于kafka客户端可控自定义配置的场景</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.KafkaProducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.Producer;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.common.config.provider.FileConfigProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">providers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        providers.put(<span class="string">&quot;bootstrap.servers&quot;</span>, <span class="string">&quot;localhost:9092&quot;</span>);</span><br><span class="line">        providers.put(<span class="string">&quot;key.serializer&quot;</span>,<span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line">        providers.put(<span class="string">&quot;value.serializer&quot;</span>,<span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line">        providers.put(<span class="string">&quot;config.providers&quot;</span>, <span class="string">&quot;x&quot;</span>);</span><br><span class="line">        providers.put(<span class="string">&quot;config.providers.x.class&quot;</span>, FileConfigProvider.class.getName());</span><br><span class="line">        providers.put(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;$&#123;x:/1.properties:password&#125;&quot;</span>);</span><br><span class="line">        Producer&lt;String, String&gt; producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;&gt;(providers);</span><br><span class="line">        producer.initTransactions();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/08/E58nRBJ9dDjKSFg.png"></p>
	
	</div>
  <a type="button" href="/2024/12/08/Apache Kafka CVE-2024-31141学习/#more" class="btn btn-default more">Read More</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">

   
    
           <a type="button" class="btn btn-default disabled"><i class="fa fa-arrow-circle-o-left"></i>Prev</a>
        

        <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
 
       <a href="/page/2/" type="button" class="btn btn-default ">Next<i class="fa fa-arrow-circle-o-right"></i></a>     
        

  
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
	<div class="widget">
		<h4>Categories</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/ctf/">ctf<span>1</span></a></li>
		
			<li><a href="/categories/cve/">cve<span>8</span></a></li>
		
			<li><a href="/categories/environment/">environment<span>1</span></a></li>
		
			<li><a href="/categories/java/">java<span>1</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/zabbix/">zabbix<span>2</span></a></li>
		
			<li><a href="/tags/writeup/">writeup<span>1</span></a></li>
		
			<li><a href="/tags/kafka/">kafka<span>1</span></a></li>
		
			<li><a href="/tags/security/">security<span>10</span></a></li>
		
			<li><a href="/tags/struts/">struts<span>2</span></a></li>
		
			<li><a href="/tags/fastjson/">fastjson<span>1</span></a></li>
		
			<li><a href="/tags/environment/">environment<span>1</span></a></li>
		
			<li><a href="/tags/kkFileView/">kkFileView<span>1</span></a></li>
		
			<li><a href="/tags/pinot/">pinot<span>1</span></a></li>
		
			<li><a href="/tags/hexo/">hexo<span>1</span></a></li>
		
			<li><a href="/tags/tomcat/">tomcat<span>1</span></a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2025/04/09/CVE-2024-36465 Zabbix SQL注入漏洞分析/"  title="首发于奇安信攻防社区 https://forum.butian.net/article/690" ><i class="fa fa-file-o"></i>CVE-2024-42327 Zabbix SQL注入...</a>
      </li>
    
      <li>
        <a href="/2025/04/03/Apache Pinot CVE-2024-56325 Authentication Bypass 漏洞分析/"  title="首发于奇安信攻防社区 https://forum.butian.net/article/685" ><i class="fa fa-file-o"></i>Apache Pinot CVE-2024-56325...</a>
      </li>
    
      <li>
        <a href="/2025/03/25/CISCN-长城杯半决赛ISW部分Writeup/"  title="AWDP坐大牢，靠ISW拯救一下" ><i class="fa fa-file-o"></i>CISCN-长城杯半决赛ISW部分Writeup</a>
      </li>
    
      <li>
        <a href="/2025/03/11/Apache Tomcat CVE-2025-24813 漏洞分析复现/" ><i class="fa fa-file-o"></i>Apache Tomcat CVE-2025-2481...</a>
      </li>
    
      <li>
        <a href="/2024/12/20/Apache Struts S2-067 漏洞分析/"  title="CVE-2024-53677" ><i class="fa fa-file-o"></i>Apache Struts S2-067 漏洞分析</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-terminal"></i><a href="https://www.dkdun.cn/" title="领先的云服务商，赞赞赞" target="_blank"]);">DK盾 | 林枫云</a></li>
	
		<li><i class="fa fa-terminal"></i><a href="https://arsenetang.github.io/" title="带我入门的汤神！" target="_blank"]);">Arsene.Tang</a></li>
	
		<li><i class="fa fa-terminal"></i><a href="http://blog.187.ink/" title="大哥带我" target="_blank"]);">L1mbo</a></li>
	
		<li><i class="fa fa-terminal"></i><a href="https://www.yuque.com/misery333" title="广义术术人 ✩ 沃玛单推人" target="_blank"]);">M1sery</a></li>
	
		<li><i class="fa fa-terminal"></i><a href="http://s0rry.cn/" title="逆向神，斩获无数大厂Offer" target="_blank"]);">s0rry</a></li>
	
		<li><i class="fa fa-terminal"></i><a href="https://infernity.top/" title="恐怖如斯的web学弟 & vn队长" target="_blank"]);">Infernity</a></li>
	
		<li><i class="fa fa-terminal"></i><a href="https://boogipop.com/" title="神" target="_blank"]);">Boogipop</a></li>
	
		<li><i class="fa fa-terminal"></i><a href="mailto:ph0ebus@qq.com" title="hello world" target="_blank"]);">好友位招租（</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2025 ph0ebus's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
